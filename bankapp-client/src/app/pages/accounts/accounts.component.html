<div class="accounts-page">

  <div class="header">
    <h2>Bank Accounts</h2>
  </div>

  <!-- Create Account Card -->
  <div class="card form-card">
    <h3>Create New Account</h3>

    <form (ngSubmit)="createAccount()">
      <div class="form-row">
        <div class="form-group">
          <label>Account Holder Name</label>
          <input
            type="text"
            [(ngModel)]="holderName"
            name="holderName"
            required
            placeholder="Enter full name"
          />
        </div>

        <div class="form-group">
          <label>Initial Balance</label>
          <input
            type="number"
            [(ngModel)]="balance"
            name="balance"
            required
            min="0"
            placeholder="0.00"
          />
        </div>
      </div>

      <button type="submit" [disabled]="loading" class="primary-btn">
        {{ loading ? 'Creating...' : 'Create Account' }}
      </button>
    </form>

    <p class="error" *ngIf="createError">{{ createError }}</p>
    <p class="success" *ngIf="successMessage">
      {{ successMessage }}
    </p>

    <div class="json-box-success" *ngIf="createdAccount">
      <p><b>Account Id:</b> {{createdAccount.id}}</p>
      <p><b>Holder Name:</b> {{createdAccount.holderName}}</p>
      <p><b>Balance:</b> {{createdAccount.balance}}</p>
    </div>

    <div class="json-box-error" *ngIf="creationErrorJson">
      <p><b>Error:</b> {{creationErrorJson.errorMessage}}</p>
      <p><b>StatusCode:</b> {{creationErrorJson.statusCode}}</p>
      <p><b>Contact:</b> {{creationErrorJson.toContact}}</p>
      <p><b>Timestamp:</b> {{creationErrorJson.timestamp}}</p>
    </div>
  </div>

  <!-- Accounts Table -->
  <div class="card table-card">
    <h3>Existing Accounts</h3>

      <div class="search-bar">
        <input
          type="text"
          [(ngModel)]="searchId"
          placeholder="Search by Account ID..."
        />

      <button class="secondary-btn" (click)="searchAccount()">
        Search
      </button>

      <button class="clear-btn" *ngIf="searchId" (click)="clearSearch()">
        Clear
      </button>
    </div>

    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Holder Name</th>
          <th>Balance</th>
          <th>Actions</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let acc of accounts">
          <td>{{ acc.id }}</td>
          <td>{{ acc.holderName }}</td>
          <td class="balance">{{ acc.balance | currency:'INR' }}</td>
          <td>
            <button class="danger-btn" (click)="deleteAccount(acc.id)">
              Delete
            </button>
          </td>
        </tr>

        <tr *ngIf="accounts?.length === 0">
          <td colspan="4" class="empty">
            No accounts found.
          </td>
        </tr>
      </tbody>
    </table>
  </div>

</div>
